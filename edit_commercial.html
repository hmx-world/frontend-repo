<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />

    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
    <title>Add/Edit Commercial</title>
    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0, shrink-to-fit=no'
        name='viewport' />
    <!--     Fonts and icons     -->
    <link href="https://fonts.googleapis.com/css?family=Montserrat:400,700,200" rel="stylesheet" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />
    <!-- CSS Files -->
    <link href="assets/css/bootstrap.min.css" rel="stylesheet" />
    <link href="assets/css/light-bootstrap-dashboard.css?v=2.0.0 " rel="stylesheet" />
    <link rel = "icon" href =
            "https://svgshare.com/i/N9e.svg"
          type = "image/x-icon">
</head>

<body style="background-color: #9dbcf7;">
    <div id="app">
        <div class="wrapper">

            <div class="main-panel">

                <div class="content">
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-md-8">
                                <div class="card">
                                    <div class="card-header" style="margin-top: 10px;">
                                        <div class="row ">
                                            <div class="col-md-3 ">
                                                <div class="form-group ">
                                                    <a href="#"> <button type="submit"
                                                            style="border-radius: 0px; margin-top: -20px;   background-color: #A8CFEF;"
                                                            class="form-control btn ">FOR SALE</button> </a>
                                                </div>
                                            </div>
                                            <div class="col-md-3 ">
                                                <div class="form-group">
                                                    <a href="#"> <button type="submit"
                                                            style="border-radius: 0px;  margin-top: -20px; background-color: #FFE066;"
                                                            class="form-control btn ">RENTAL</button></a>

                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <a href="#"> <button type="submit"
                                                            style="border-radius: 0px;  margin-top: -20px; background-color: #99F2A7;"
                                                            class="form-control btn active">COMMERCIAL</button></a>

                                                </div>
                                            </div>
                                            <div class="col-md-3">
                                                <div class="form-group">
                                                    <a href="#"> <button type="submit"
                                                            style=" border-radius: 0px;  background-color: #FF8888;  margin-top: -20px;"
                                                            class="form-control btn">LAND</button></a>

                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="card-body" style="color: black;">
                                        <form method="POST">
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>Name:</label>
                                                        <input v-model="name" type="text" required
                                                            style="border-radius: 0px;" class="form-control"
                                                            placeholder="" value="">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>Price:</label>
                                                        <input v-model="price" type="text" required
                                                            style="border-radius: 0px;" class="form-control"
                                                            placeholder="" value="">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="form-group" style="border-radius: 0px;">
                                                        <label>Building Type</label>
                                                        <select name="" v-model="buildingType" id=""
                                                            style="border-radius: 0px;" class="form-control">
                                                            <option value="bungalow">Bungalow</option>
                                                            <option value="Duplex">Duplex</option>
                                                            <option value="Mansion"> Mansion</option>
                                                            <option value="3 storey building">3 storey building</option>
                                                            <option value="much more">Much more</option>

                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6 ">
                                                    <div class="form-group">
                                                        <label>Purpose: </label>
                                                        <select name="" v-model="purpose" id=""
                                                            style="border-radius: 0px;" style="border-radius: 0px;"
                                                            class="form-control">
                                                            <option value="0">Rent</option>
                                                            <option value="1">To-let</option>
                                                            <option value="2"> Service Apartments
                                                            </option>


                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-6 ">
                                                    <div class="form-group ">
                                                        <label>Number of Bedrooms</label>
                                                        <input v-model="numberofbedrooms" type="number"
                                                            style="border-radius: 0px;" min="1" class="form-control"
                                                            placeholder="2">
                                                    </div>

                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>Street Address: </label>
                                                        <input v-model="town" type="text" style="border-radius: 0px;"
                                                            class="form-control" placeholder="" value="">

                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6 ">
                                                    <div class="form-group ">
                                                        <label>State/Territory: </label>
                                                        <select v-model="state"  name=""
                                                                style="border-radius: 0px;" class="form-control">
                                                            <option value="">Please Select...</option>
                                                            <option v-for="(value, key) in selectObj" :value="key" >{{key}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                                <div class="col-md-6 ">
                                                    <div class="form-group">
                                                        <label>City: </label>
                                                        <select v-model="city" name="" id="" style="border-radius: 0px;"
                                                                class="form-control">
                                                            <option value="">Please Select...</option>
                                                            <option v-for="city in selectObj[state]" :value="city" >{{city}}</option>
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6 ">
                                                    <div class="form-group">
                                                        <label>Neighbourhood Security: </label>
                                                        <input v-model="neighbourhoodsecurity" type="number"
                                                            style="border-radius: 0px;" class="form-control" min="1"
                                                            max="10" placeholder="2">

                                                    </div>
                                                </div>
                                                <div class="col-md-6 ">
                                                    <div class="form-group ">
                                                        <br><br>
                                                        <p> (1 is least secured. 10 is most secured) </p>
                                                    </div>

                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-md-6 pr-1">
                                                    <div class="form-group">
                                                        <label>Land Area (m.sq):</label>
                                                        <input v-model="area" type="text" style="border-radius: 0px;"
                                                            class="form-control" placeholder="" value="">
                                                    </div>
                                                </div>
                                                <div class="col-md-6 px-1">
                                                    <div class="form-group">
                                                        <label>Parking Space:</label>
                                                        <select v-model="parkingspace" name="" id=""
                                                            style="border-radius: 0px;" class="form-control">
                                                            <option value="true">Available</option>
                                                            <option value="false">Not Available</option>


                                                        </select>
                                                    </div>
                                                </div>

                                            </div>
                                            <div class="row">
                                                <div class="col-md-12 pr-1">
                                                    <div class="form-group">
                                                        <label>Property Images: </label>
                                                        <div class="row">
                                                            <img class="card-img-top img-fluid" v-if="updatedResponse.imageLink1!='#'" style="height: inherit; width: 40%"  :src="updatedResponse.imageLink1" class="img-fluid w-40 h-40" alt="Property image 1">
                                                            <img class="card-img-top img-fluid" style="height: inherit; width: 40%"  v-if="updatedResponse.imageLink2!='#'" :src="updatedResponse.imageLink2" class="img-fluid w-40 h-40" alt="Property image 2">
                                                            <img class="card-img-top img-fluid" style="height: inherit; width: 40%"  v-if="updatedResponse.imageLink3!='#'"  :src="updatedResponse.imageLink3" class="img-fluid w-40 h-40" alt="Property image 3">
                                                            <img class="card-img-top img-fluid" style="height: inherit; width: 40%"  v-if="updatedResponse.imageLink4!='#'"  :src="updatedResponse.imageLink4" class="img-fluid w-40 h-40" alt="Property image 4">

                                                        </div>
                                                    </div>
                                                </div>

                                            </div>


                                            <div class="row">
                                                <div class="col-md-12">
                                                    <div class="form-group">
                                                        <label>Property Description: </label>
                                                        <textarea rows="4" v-model="extras" cols="80"
                                                            style="border-radius: 0px; height: 100px;"
                                                            class="form-control" placeholder="" value=""></textarea>
                                                    </div>
                                                </div>
                                            </div>
                                            <div style="width: 100%" v-if="isLoading">
                                                <div class="lds-ripple">
                                                    <button @click.prevent="submitToInternet" type="submit"
                                                            class="btn btn-info btn-fill "
                                                            style="width: 100%; cursor: pointer; background-color: #044CBC; "><strong>UPDATE
                                                        PROPERTY</strong></button>
                                                    <div></div><div></div>
                                                </div>
                                            </div>
                                            <div style="width: 100%" v-else>
                                                <button @click.prevent="submitToInternet" type="submit"
                                                        class="btn btn-info btn-fill "
                                                        style="width: 100%; cursor: pointer; background-color: #044CBC; "><strong>UPDATE
                                                    PROPERTY</strong></button>
                                            </div>
                                            <div class="clearfix"></div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

</body>
<!--   Core JS Files   -->
<script src="assets/js/core/jquery.3.2.1.min.js" type="text/javascript"></script>
<script src="assets/js/core/popper.min.js" type="text/javascript"></script>
<script src="assets/js/core/bootstrap.min.js" type="text/javascript"></script>
<script src="assets/js/plugins/bootstrap-switch.js"></script>
<!--  Google Maps Plugin    -->
<script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.js"></script>
<script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.js"></script>
<script src="assets/js/light-bootstrap-dashboard.js?v=2.0.0 " type="text/javascript"></script>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>

<script>

    let userFormData = new FormData();
  var app = new Vue({
    el: '#app',
    data: {
        editId: '',
      updatedResponse: '',
      name: '',
      area:'',
      price: '',
      buildingType: '',
      numberofbedrooms: '',
      neighbourhoodsecurity: '',
      Title: '',
      landarea: '',
      city: '',
      state: '',
      town: '',
      sitedescription: '',
      imageFile1: '',
      imageFile2: '',
      imageFile3: '',
      imageFile4: '',
      purpose:'',
      parkingspace:'',
        isLoading: false,
      extras: '',
        selectCityObj: [],
        selectObj: {
            'Lagos': ['Alimosho','Ajeromi','Ifelodun','Kosofe','Mushin','Oshodi-Isolo','Ojo','Ikorodu','Surulere','Ifako-Ijaiye','Somolu','Amuwo-Odofin','Lagos Mainland','Ikeja','Eti-Osa','Badagry','Apapa','Lagos Island','Epe','Ibeju-Lekki'],
            'Abuja': ['Asokoro','Bamburu','Mararaba','Gwarinpa','Wuse','Maitama','Abuja Airport','Garki','Karu','Kubwa','Kurunduma','Jikwoyi','Masaka','Eketahuna','New Nyanya','Karshi','Yoba','Zuba']
        }

    },
    created()
  {
    let uri = window.location.href.split('?');
    let vars = uri[1].split('=');
    //let params = new URLSearchParams(uri);
    console.log(vars[1]);
    this.editId = vars[1];
    this.fetchProperty();
  },
  updated(){
  },
    methods: {
        fetchProperty() {
                axios.defaults.baseURL = 'https://hmxserver.azurewebsites.net/api/';
                axios.get('/property/commercial/' + this.editId, {
                    headers: {
                        "Authorization": "Bearer " + localStorage.getItem("token").slice(1, -1),
                        "Access-Control-Allow-Origin": "*"
                    }
                }).then(response => {
                    this.updatedResponse = response.data;
                    this.name = this.updatedResponse.name;
                    this.price = this.updatedResponse.price;
                    this.Title = this.updatedResponse.title;
                    this.area = this.updatedResponse.area;
                    this.buildingType = this.updatedResponse.buildingType;
                    this.numberofbedrooms = this.updatedResponse.numberOfBedrooms;
                    this.neighbourhoodsecurity = this.updatedResponse.neighbourhoodSecurity;
                    this.parkingspace = this.updatedResponse.parkingSpace;
                    this.city = this.updatedResponse.city;
                    this.state = this.updatedResponse.state;
                    this.town = this.updatedResponse.town;
                    this.landarea = this.updatedResponse.landArea;
                    this.sitedescription = this.updatedResponse.siteDescription;
                    this.imageFile1 = this.updatedResponse.imageFile1;
                    this.imageFile2 = this.updatedResponse.imageFile2;
                    this.imageFile3 = this.updatedResponse.imageFile3;
                    this.imageFile4 = this.updatedResponse.imageFile4;
                    this.extras = this.updatedResponse.extras;
                    this.purpose = this.updatedResponse.purpose; 
                });
        },
      submitToInternet() {
          this.isLoading = true;
        //alert("Update of Commercial Property in progress "+this.name +"\nIf no redirection some fields are required");
        axios.defaults.baseURL = 'https://hmxserver.azurewebsites.net/api/'; 
        axios.put('/firm/commercial/'+this.editId,
        {
            name: this.name,
            price: this.price,
            Title: this.title,
            area: this.area,
            providerName: localStorage.getItem("providerName"),
            FirmId: localStorage.getItem("FirmId"),
            buildingType: this.buildingType,
            numberofbedrooms: this.numberOfBedrooms,
            neighbourhoodsecurity: this.neighbourhoodSecurity,
            parkingspace: this.parkingSpace,
            city: this.city,
            state: this.state,
            town: this.town,
            landarea: this.landArea,
            sitedescription: this.siteDescription,
            imageFile1: this.imageFile1,
            imageFile1: this.imageFile2,
            imageFile1: this.imageFile3,
            imageFile1: this.imageFile4,
            extras: this.extras,
            purpose: this.purpose,
            selectCityObj: [],
            selectObj: {
                'Lagos': ['Alimosho','Ajeromi','Ifelodun','Kosofe','Mushin','Oshodi-Isolo','Ojo','Ikorodu','Surulere','Ifako-Ijaiye','Somolu','Amuwo-Odofin','Lagos Mainland','Ikeja','Eti-Osa','Badagry','Apapa','Lagos Island','Epe','Ibeju-Lekki'],
                'Abuja': ['Asokoro','Bamburu','Mararaba','Gwarinpa','Wuse','Maitama','Abuja Airport','Garki','Karu','Kubwa','Kurunduma','Jikwoyi','Masaka','Eketahuna','New Nyanya','Karshi','Yoba','Zuba']
            }
        },
        {
          headers: {
              "Authorization" : "Bearer "+localStorage.getItem("token").slice(1,-1),
            "Access-Control-Allow-Origin" : "*"
          }
        }).catch(function(error) {
          console.log(error);
            alert('Try updating property again...');
            this.isLoading=false;
            window.location = "#";
        }).then(response => {
            console.log(response);
           window.location="https://hmx-world.github.io/frontend-repo/firmdashboard.html";
          }).finally(() => {
            this.isLoading=false;
        })
      }
    },

  })
  </script>


</html>
